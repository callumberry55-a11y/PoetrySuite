import{u as N,r as l,s as n,j as e,K as C,n as _,X as G}from"./index-CGemffCt.js";import{P as b}from"./plus-zAg5GACl.js";import{S}from"./search-CC5W77On.js";import{G as z}from"./globe-DrygjtXM.js";import{L as E}from"./lock-Bpvz4WVX.js";function J(){const{user:a}=N(),[g,h]=l.useState([]),[f,m]=l.useState(!0),[d,y]=l.useState(""),[j,i]=l.useState(!1),[u,x]=l.useState(!1),[t,o]=l.useState({name:"",description:"",topic:"",is_private:!1});l.useEffect(()=>{a&&c()},[a]);const c=async()=>{m(!0);try{const{data:r,error:s}=await n.from("study_groups").select("*").eq("is_private",!1).order("created_at",{ascending:!1});if(s)throw s;h(r||[])}catch(r){console.error("Error loading groups:",r)}finally{m(!1)}},k=async r=>{try{await n.from("study_group_members").insert({group_id:r,user_id:a==null?void 0:a.id,role:"member"}),c()}catch(s){console.error("Error joining group:",s)}},w=async r=>{if(r.preventDefault(),!(!a||!t.name.trim())){x(!0);try{const{data:s,error:p}=await n.from("study_groups").insert({name:t.name,description:t.description,topic:t.topic,is_private:t.is_private,created_by:a.id}).select().single();if(p)throw p;await n.from("study_group_members").insert({group_id:s.id,user_id:a.id,role:"admin"}),o({name:"",description:"",topic:"",is_private:!1}),i(!1),c()}catch(s){console.error("Error creating group:",s),alert("Failed to create study group")}finally{x(!1)}}},v=g.filter(r=>!d||r.name.toLowerCase().includes(d.toLowerCase())||r.topic.toLowerCase().includes(d.toLowerCase()));return e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Study Groups"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(b,{size:20}),"Create Group"]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search groups...",value:d,onChange:r=>y(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),f?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-emerald-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:v.map(r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("span",{className:"inline-block px-3 py-1 text-xs font-medium bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-full mb-3",children:r.topic}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:r.name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:r.description}),e.jsxs("button",{onClick:()=>k(r.id),className:"w-full px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Join Group"]})]},r.id))}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Create Study Group"}),e.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(G,{size:20,className:"text-slate-500"})})]}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"group-name",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Group Name *"}),e.jsx("input",{id:"group-name",type:"text",value:t.name,onChange:r=>o({...t,name:r.target.value}),placeholder:"e.g., Poetry Writing Workshop",required:!0,className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"group-topic",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Topic *"}),e.jsx("input",{id:"group-topic",type:"text",value:t.topic,onChange:r=>o({...t,topic:r.target.value}),placeholder:"e.g., Sonnets, Haiku, Free Verse",required:!0,className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"group-description",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Description"}),e.jsx("textarea",{id:"group-description",value:t.description,onChange:r=>o({...t,description:r.target.value}),placeholder:"Describe what this study group is about...",rows:4,className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Privacy"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>o({...t,is_private:!1}),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 transition-all ${t.is_private?"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-400 hover:border-slate-400":"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400"}`,children:[e.jsx(z,{size:18}),e.jsx("span",{className:"font-medium",children:"Public"})]}),e.jsxs("button",{type:"button",onClick:()=>o({...t,is_private:!0}),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg border-2 transition-all ${t.is_private?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-400 hover:border-slate-400"}`,children:[e.jsx(E,{size:18}),e.jsx("span",{className:"font-medium",children:"Private"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2.5 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u||!t.name.trim()||!t.topic.trim(),className:"flex-1 px-4 py-2.5 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-400 text-white rounded-lg transition-colors font-medium flex items-center justify-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{size:18}),"Create Group"]})})]})]})]})})]})}export{J as default};
