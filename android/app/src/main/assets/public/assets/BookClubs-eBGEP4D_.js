import{u as _,r as o,s as n,j as e,w as S,n as M,M as E}from"./index-CGemffCt.js";import{P as L}from"./plus-zAg5GACl.js";import{S as B}from"./search-CC5W77On.js";import{L as D}from"./lock-Bpvz4WVX.js";import{G as q}from"./globe-DrygjtXM.js";import{C as P}from"./calendar-_Ckto2X5.js";function T(){const{user:a}=_(),[h,y]=o.useState([]),[p,f]=o.useState([]),[l,b]=o.useState("discover"),[i,k]=o.useState(""),[v,m]=o.useState(!1),[j,g]=o.useState(!0),[s,d]=o.useState({name:"",description:"",current_book:"",meeting_schedule:"",is_private:!1,max_members:50});o.useEffect(()=>{a&&x()},[a,l]);const x=async()=>{g(!0);try{if(l==="discover"){const{data:r,error:t}=await n.from("book_clubs").select("*").eq("is_private",!1).order("created_at",{ascending:!1});if(t)throw t;y(r||[])}else{const{data:r,error:t}=await n.from("book_club_members").select(`
            club_id,
            book_clubs (*)
          `).eq("user_id",a==null?void 0:a.id);if(t)throw t;const c=(r==null?void 0:r.map(C=>C.book_clubs).filter(Boolean).flat())||[];f(c)}}catch(r){console.error("Error loading clubs:",r)}finally{g(!1)}},w=async r=>{r.preventDefault();try{const{data:t,error:c}=await n.from("book_clubs").insert({...s,created_by:a==null?void 0:a.id}).select().single();if(c)throw c;await n.from("book_club_members").insert({club_id:t.id,user_id:a==null?void 0:a.id,role:"admin"}),m(!1),d({name:"",description:"",current_book:"",meeting_schedule:"",is_private:!1,max_members:50}),x()}catch(t){console.error("Error creating club:",t)}},N=async r=>{try{const{error:t}=await n.from("book_club_members").insert({club_id:r,user_id:a==null?void 0:a.id,role:"member"});if(t)throw t;x()}catch(t){console.error("Error joining club:",t)}},u=()=>{const r=l==="discover"?h:p;return i?r.filter(t=>t.name.toLowerCase().includes(i.toLowerCase())||t.description.toLowerCase().includes(i.toLowerCase())):r};return e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Poetry Book Clubs"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Create Club"]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Join virtual reading groups to discuss poetry books, share insights, and connect with fellow poetry enthusiasts."}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("button",{onClick:()=>b("discover"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${l==="discover"?"border-emerald-600 text-emerald-600 dark:text-emerald-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:"Discover Clubs"}),e.jsx("button",{onClick:()=>b("my-clubs"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${l==="my-clubs"?"border-emerald-600 text-emerald-600 dark:text-emerald-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:"My Clubs"})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clubs...",value:i,onChange:r=>k(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),j?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-emerald-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:u().length===0?e.jsx("div",{className:"col-span-full text-center py-12 text-gray-500 dark:text-gray-400",children:i?"No clubs found matching your search.":"No clubs available. Create one to get started!"}):u().map(r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 hover:border-emerald-400 dark:hover:border-emerald-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r.name}),r.is_private?e.jsx(D,{className:"w-5 h-5 text-gray-400"}):e.jsx(q,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 line-clamp-2",children:r.description}),r.current_book&&e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-emerald-900 dark:text-emerald-100 mb-1",children:"Currently Reading:"}),e.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-300",children:r.current_book})]}),r.meeting_schedule&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-4",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:r.meeting_schedule})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsxs("span",{children:[r.member_count||0," members"]})]}),l==="discover"&&e.jsx("button",{onClick:()=>N(r.id),className:"px-4 py-2 text-sm font-medium bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"Join Club"}),l==="my-clubs"&&e.jsxs("button",{className:"px-4 py-2 text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Discuss"]})]})]},r.id))}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Create Book Club"}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Club Name"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:r=>d({...s,name:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{required:!0,value:s.description,onChange:r=>d({...s,description:r.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current Book (optional)"}),e.jsx("input",{type:"text",value:s.current_book,onChange:r=>d({...s,current_book:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Meeting Schedule (optional)"}),e.jsx("input",{type:"text",placeholder:"e.g., Weekly on Mondays, 7 PM",value:s.meeting_schedule,onChange:r=>d({...s,meeting_schedule:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_private",checked:s.is_private,onChange:r=>d({...s,is_private:r.target.checked}),className:"w-4 h-4 text-emerald-600 border-gray-300 rounded focus:ring-emerald-500"}),e.jsx("label",{htmlFor:"is_private",className:"text-sm text-gray-700 dark:text-gray-300",children:"Make this club private"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"Create"})]})]})]})})]})}export{T as default};
