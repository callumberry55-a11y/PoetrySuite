import{u as _,r as a,s as n,j as e,l as c,i as f,g as j}from"./index-2dP_p1EG.js";import{C as k}from"./clock-DJOLL9Lo.js";import{M as N,T as w}from"./thumbs-up-Xcjv8glW.js";function S(){const{user:t}=_(),[i,p]=a.useState([]),[o,d]=a.useState(!0),m=a.useCallback(async()=>{if(!t)return;const{data:s,error:x}=await n.from("contests").select(`
        *,
        winner_badge:winner_badge_id(id, name, rank, points),
        runner_up_badge:runner_up_badge_id(id, name, rank, points),
        participant_badge:participant_badge_id(id, name, rank, points)
      `).in("status",["active","voting","upcoming"]).order("start_date",{ascending:!0});if(x){console.error("Error loading contests:",x),d(!1);return}const g=await Promise.all((s||[]).map(async l=>{const{count:b}=await n.from("contest_entries").select("id",{count:"exact",head:!0}).eq("contest_id",l.id),{data:h}=await n.from("contest_entries").select("id").eq("contest_id",l.id).eq("user_id",t.id).maybeSingle();return{...l,entry_count:b||0,user_has_entered:!!h}}));p(g),d(!1)},[t]);a.useEffect(()=>{t&&m()},[t,m]);const u=s=>{switch(s){case"upcoming":return"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/20 dark:text-cyan-400";case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"voting":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400";default:return"bg-slate-100 text-slate-800 dark:bg-slate-900/20 dark:text-slate-400"}},r=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:py-8 pb-24",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 dark:text-white mb-1 sm:mb-2",children:"Poetry Contests"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 dark:text-slate-400",children:"Compete with fellow poets for recognition and prizes"})]}),o?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):i.length===0?e.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-800 rounded-lg",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No active contests at the moment"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:i.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-3 sm:mb-4 gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(c,{className:"text-yellow-500 flex-shrink-0",size:18}),e.jsx("h3",{className:"text-base sm:text-xl font-bold text-slate-900 dark:text-white truncate",children:s.title})]}),e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${u(s.status)}`,children:s.status.toUpperCase()})]})}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 dark:text-slate-400 mb-4 line-clamp-3",children:s.description}),s.theme&&e.jsxs("div",{className:"mb-4 p-3 bg-slate-50 dark:bg-slate-700 rounded-lg",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Theme"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-900 dark:text-white font-serif",children:s.theme})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:[e.jsx(k,{size:12,className:"sm:w-[14px] sm:h-[14px] flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[s.status==="upcoming"&&`Starts ${r(s.start_date)}`,s.status==="active"&&`Ends ${r(s.end_date)}`,s.status==="voting"&&`Voting ends ${r(s.voting_end_date)}`]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:[e.jsx(f,{size:12,className:"sm:w-[14px] sm:h-[14px] flex-shrink-0"}),e.jsxs("span",{children:[s.entry_count," entries"]})]})]}),(s.winner_badge||s.runner_up_badge||s.participant_badge)&&e.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-900/20 dark:to-emerald-800/20 rounded-lg",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-emerald-800 dark:text-emerald-300 mb-2",children:"Badge Rewards"}),e.jsxs("div",{className:"space-y-2",children:[s.winner_badge&&e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx(c,{size:14,className:"text-yellow-600 dark:text-yellow-400 flex-shrink-0"}),e.jsxs("span",{className:"text-emerald-900 dark:text-emerald-200",children:[e.jsx("strong",{children:"1st:"})," ",s.winner_badge.name," (",s.winner_badge.rank," • ",s.winner_badge.points," pts)"]})]}),s.runner_up_badge&&e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx(N,{size:14,className:"text-slate-400 flex-shrink-0"}),e.jsxs("span",{className:"text-emerald-900 dark:text-emerald-200",children:[e.jsx("strong",{children:"2nd-3rd:"})," ",s.runner_up_badge.name," (",s.runner_up_badge.rank," • ",s.runner_up_badge.points," pts)"]})]}),s.participant_badge&&e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm",children:[e.jsx(j,{size:14,className:"text-purple-500 flex-shrink-0"}),e.jsxs("span",{className:"text-emerald-900 dark:text-emerald-200",children:[e.jsx("strong",{children:"All:"})," ",s.participant_badge.name," (",s.participant_badge.rank," • ",s.participant_badge.points," pts)"]})]})]})]}),s.status==="active"&&e.jsx("button",{disabled:s.user_has_entered,className:`w-full px-4 py-2 rounded-lg font-medium transition-colors touch-manipulation text-sm sm:text-base ${s.user_has_entered?"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-400 cursor-not-allowed":"bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white"}`,children:s.user_has_entered?"Already Entered":"Submit Entry"}),s.status==="voting"&&e.jsxs("button",{className:"w-full px-4 py-2 bg-violet-500 hover:bg-violet-600 active:bg-violet-700 text-white rounded-lg font-medium transition-colors touch-manipulation flex items-center justify-center gap-2 text-sm sm:text-base",children:[e.jsx(w,{size:14,className:"sm:w-4 sm:h-4"}),"Vote Now"]})]},s.id))})]})}export{S as default};
