import{u as $,r as n,s as o,j as e,b as u,S as p,B as C,T,m as q,Z as G,A as S}from"./index-CGemffCt.js";import{C as v}from"./calendar-_Ckto2X5.js";import{C as O}from"./clock-CH5mnwFd.js";import{F as I}from"./file-text-_fS2G5mZ.js";const m=[{days:7,title:"One Week",emoji:"ðŸ”¥",color:"orange",bgGradient:"from-orange-500 to-red-500"},{days:14,title:"Two Weeks",emoji:"âš¡",color:"yellow",bgGradient:"from-yellow-500 to-amber-500"},{days:30,title:"One Month",emoji:"ðŸŒŸ",color:"blue",bgGradient:"from-blue-500 to-cyan-500"},{days:60,title:"Two Months",emoji:"ðŸ’Ž",color:"cyan",bgGradient:"from-cyan-500 to-teal-500"},{days:100,title:"100 Days",emoji:"ðŸ†",color:"amber",bgGradient:"from-amber-500 to-yellow-500"},{days:365,title:"One Year",emoji:"ðŸ‘‘",color:"purple",bgGradient:"from-purple-500 to-pink-500"}];function F(){const{user:s}=$(),[r,f]=n.useState(null),[h,x]=n.useState([]),[i,j]=n.useState(null),[D,k]=n.useState(!0),[N,b]=n.useState(!1),[g,w]=n.useState(null);n.useEffect(()=>(s&&(z(),E()),()=>{o.channel("writing_streaks_channel").unsubscribe(),o.channel("user_achievements_channel").unsubscribe(),o.channel("daily_writing_logs_channel").unsubscribe()}),[s]);const z=async()=>{k(!0);try{const a=new Date().toISOString().split("T")[0],{data:t}=await o.from("writing_streaks").select("*").eq("user_id",s==null?void 0:s.id).maybeSingle(),{data:l}=await o.from("user_achievements").select("*").eq("user_id",s==null?void 0:s.id).order("earned_at",{ascending:!1}),{data:d}=await o.from("daily_writing_logs").select("*").eq("user_id",s==null?void 0:s.id).eq("write_date",a).maybeSingle();f(t),x(l||[]),j(d)}catch(a){console.error("Error loading data:",a)}finally{k(!1)}},M=n.useCallback(a=>{m.find(l=>l.days===a)&&(b(!0),setTimeout(()=>b(!1),3e3))},[]),E=()=>{if(!(s!=null&&s.id))return;const a=new Date().toISOString().split("T")[0];o.channel("writing_streaks_channel").on("postgres_changes",{event:"*",schema:"public",table:"writing_streaks",filter:`user_id=eq.${s.id}`},t=>{if(t.eventType==="INSERT"||t.eventType==="UPDATE"){const l=t.new;f(l),M(l.current_streak)}}).subscribe(),o.channel("user_achievements_channel").on("postgres_changes",{event:"*",schema:"public",table:"user_achievements",filter:`user_id=eq.${s.id}`},t=>{if(t.eventType==="INSERT"){const l=t.new;x(d=>[l,...d]),w(l),b(!0),setTimeout(()=>{b(!1),w(null)},4e3)}else t.eventType==="UPDATE"?x(l=>l.map(d=>d.id===t.new.id?t.new:d)):t.eventType==="DELETE"&&x(l=>l.filter(d=>d.id!==t.old.id))}).subscribe(),o.channel("daily_writing_logs_channel").on("postgres_changes",{event:"*",schema:"public",table:"daily_writing_logs",filter:`user_id=eq.${s.id}`},t=>{(t.eventType==="INSERT"||t.eventType==="UPDATE")&&t.new.write_date===a&&j(t.new)}).subscribe()},y=()=>{const a=(r==null?void 0:r.current_streak)||0;return m.find(t=>t.days>a)||m[m.length-1]},A=()=>{const a=(r==null?void 0:r.current_streak)||0,t=y();return a/t.days*100};if(D)return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-slate-200 dark:border-slate-700"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-orange-600 border-t-transparent animate-spin"})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 font-medium",children:"Loading your progress..."})]})});const c=y(),_=A();return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 pb-24",children:[N&&e.jsxs("div",{className:"fixed inset-0 z-50 pointer-events-none flex items-center justify-center overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm animate-in fade-in duration-300"}),[...Array(50)].map((a,t)=>e.jsx("div",{className:"absolute w-3 h-3 rounded-full animate-ping",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${1+Math.random()*2}s`,background:["#f59e0b","#ef4444","#3b82f6","#10b981","#8b5cf6","#ec4899"][Math.floor(Math.random()*6)]}},t)),g&&e.jsx("div",{className:"relative bg-white dark:bg-slate-900 rounded-3xl shadow-2xl border-4 border-amber-500 p-8 max-w-md mx-4 animate-in zoom-in duration-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-7xl mb-4 animate-bounce",children:"ðŸŽ‰"}),e.jsx("h2",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-2",children:"Achievement Unlocked!"}),e.jsx("h3",{className:"text-xl font-semibold text-amber-600 dark:text-amber-400 mb-2",children:g.achievement_name}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:g.achievement_description})]})})]}),e.jsxs("div",{className:"relative bg-gradient-to-r from-orange-600 via-red-600 to-rose-600 h-32 sm:h-40",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[e.jsx(u,{className:"w-10 h-10 sm:w-12 sm:h-12 mb-2 animate-pulse"}),e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold mb-1",children:"Writing Streaks"}),e.jsx("p",{className:"text-sm sm:text-base opacity-90",children:"Track your daily writing journey"})]})]}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 -mt-8 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800 p-6 sm:p-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl shadow-lg",children:e.jsx(v,{className:"text-white",size:24})}),e.jsx("span",{children:"Today's Activity"})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"group bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-2xl p-6 border border-blue-100 dark:border-blue-900/30 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(O,{className:"text-blue-600 dark:text-blue-400",size:32}),e.jsx(p,{className:"text-blue-400 dark:text-blue-500 opacity-50",size:20})]}),e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-1",children:(i==null?void 0:i.minutes_spent)||0}),e.jsx("div",{className:"text-sm font-semibold text-blue-700 dark:text-blue-300",children:"Minutes"})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-2xl p-6 border border-emerald-100 dark:border-emerald-900/30 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(C,{className:"text-emerald-600 dark:text-emerald-400",size:32}),e.jsx(p,{className:"text-emerald-400 dark:text-emerald-500 opacity-50",size:20})]}),e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent mb-1",children:(i==null?void 0:i.poems_written)||0}),e.jsx("div",{className:"text-sm font-semibold text-emerald-700 dark:text-emerald-300",children:"Poems"})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-violet-50 to-purple-50 dark:from-violet-900/20 dark:to-purple-900/20 rounded-2xl p-6 border border-violet-100 dark:border-violet-900/30 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(I,{className:"text-violet-600 dark:text-violet-400",size:32}),e.jsx(p,{className:"text-violet-400 dark:text-violet-500 opacity-50",size:20})]}),e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-transparent mb-1",children:(i==null?void 0:i.word_count)||0}),e.jsx("div",{className:"text-sm font-semibold text-violet-700 dark:text-violet-300",children:"Words"})]})]})]}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-3",children:[e.jsxs("div",{className:`group relative bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 rounded-3xl border-2 border-orange-200 dark:border-orange-900/40 p-8 overflow-hidden hover:shadow-2xl transition-all ${N?"animate-pulse":""}`,children:[e.jsx("div",{className:"absolute top-4 right-4 opacity-20",children:e.jsx(u,{size:80,className:"text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsx("div",{className:"p-3 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl shadow-lg",children:e.jsx(u,{className:"text-white",size:28})})}),e.jsx("div",{className:"text-6xl font-bold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-2",children:(r==null?void 0:r.current_streak)||0}),e.jsx("div",{className:"text-base font-bold text-orange-700 dark:text-orange-300 uppercase tracking-wide mb-1",children:"Day Streak"}),e.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Keep the fire burning!"})]})]}),e.jsxs("div",{className:"group relative bg-white dark:bg-slate-900 rounded-3xl border-2 border-slate-200 dark:border-slate-800 p-8 overflow-hidden hover:shadow-2xl transition-all",children:[e.jsx("div",{className:"absolute top-4 right-4 opacity-10",children:e.jsx(T,{size:80,className:"text-emerald-600 dark:text-emerald-400"})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsx("div",{className:"p-3 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-2xl shadow-lg",children:e.jsx(T,{className:"text-white",size:28})})}),e.jsx("div",{className:"text-6xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent mb-2",children:(r==null?void 0:r.longest_streak)||0}),e.jsx("div",{className:"text-base font-bold text-emerald-700 dark:text-emerald-300 uppercase tracking-wide mb-1",children:"Longest Streak"}),e.jsx("div",{className:"text-xs text-emerald-600 dark:text-emerald-400",children:"Personal record"})]})]}),e.jsxs("div",{className:"group relative bg-white dark:bg-slate-900 rounded-3xl border-2 border-slate-200 dark:border-slate-800 p-8 overflow-hidden hover:shadow-2xl transition-all",children:[e.jsx("div",{className:"absolute top-4 right-4 opacity-10",children:e.jsx(v,{size:80,className:"text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl shadow-lg",children:e.jsx(v,{className:"text-white",size:28})})}),e.jsx("div",{className:"text-6xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:(r==null?void 0:r.total_writing_days)||0}),e.jsx("div",{className:"text-base font-bold text-blue-700 dark:text-blue-300 uppercase tracking-wide mb-1",children:"Total Days"}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Days written"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800 p-6 sm:p-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-purple-500 rounded-2xl shadow-lg",children:e.jsx(q,{className:"text-white",size:24})}),e.jsx("span",{children:"Next Milestone"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-violet-50 to-purple-50 dark:from-violet-900/20 dark:to-purple-900/20 rounded-2xl p-6 border-2 border-violet-200 dark:border-violet-900/40",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-violet-700 dark:text-violet-300 mb-1",children:c.title}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:[e.jsx("span",{className:"bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-transparent",children:(r==null?void 0:r.current_streak)||0}),e.jsxs("span",{className:"text-slate-400 dark:text-slate-600",children:[" / ",c.days]})]})]}),e.jsx("div",{className:"text-6xl animate-bounce",children:c.emoji})]}),e.jsx("div",{className:"relative h-4 bg-violet-200 dark:bg-violet-900/50 rounded-full overflow-hidden",children:e.jsx("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${c.bgGradient} rounded-full transition-all duration-1000 ease-out`,style:{width:`${Math.min(_,100)}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})}),e.jsxs("div",{className:"mt-2 text-xs text-violet-600 dark:text-violet-400 text-right",children:[Math.round(_),"% complete"]})]}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3 mt-6",children:m.map(a=>{const t=((r==null?void 0:r.current_streak)||0)>=a.days,l=a.days===c.days,d=()=>{if(t)switch(a.color){case"orange":return"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/30 dark:to-orange-800/20 border-orange-300 dark:border-orange-800";case"yellow":return"bg-gradient-to-br from-yellow-50 to-yellow-100 dark:from-yellow-900/30 dark:to-yellow-800/20 border-yellow-300 dark:border-yellow-800";case"blue":return"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 border-blue-300 dark:border-blue-800";case"cyan":return"bg-gradient-to-br from-cyan-50 to-cyan-100 dark:from-cyan-900/30 dark:to-cyan-800/20 border-cyan-300 dark:border-cyan-800";case"amber":return"bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/30 dark:to-amber-800/20 border-amber-300 dark:border-amber-800";case"purple":return"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/20 border-purple-300 dark:border-purple-800";default:return"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-700 border-slate-300 dark:border-slate-600"}else if(l)return"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-700 border-slate-300 dark:border-slate-600 ring-2 ring-violet-500";return"bg-slate-50 dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 opacity-50"};return e.jsxs("div",{className:`relative rounded-2xl p-4 border-2 transition-all ${d()}`,children:[t&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(G,{className:"text-amber-500",size:16})}),e.jsx("div",{className:"text-3xl mb-2",children:a.emoji}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:a.title}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:[a.days," days"]})]},a.days)})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800 p-6 sm:p-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-yellow-500 rounded-2xl shadow-lg",children:e.jsx(S,{className:"text-white",size:24})}),e.jsx("span",{children:"Achievements"}),e.jsx("span",{className:"ml-auto text-base sm:text-lg font-semibold px-4 py-2 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 rounded-full",children:h.length})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:h.length===0?e.jsxs("div",{className:"col-span-2 text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4 opacity-50",children:"ðŸ†"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg mb-2",children:"No achievements yet"}),e.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:"Keep writing to unlock your first achievement!"})]}):h.map((a,t)=>e.jsx("div",{className:"group bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 rounded-2xl border-2 border-amber-200 dark:border-amber-900/40 p-5 hover:shadow-xl transition-all hover:scale-105",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-yellow-500 rounded-2xl shadow-lg flex-shrink-0",children:e.jsx(S,{className:"text-white",size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white mb-1 text-lg",children:a.achievement_name}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 leading-relaxed mb-2",children:a.achievement_description}),e.jsxs("div",{className:"text-xs text-amber-600 dark:text-amber-400 font-semibold",children:["Earned ",new Date(a.earned_at).toLocaleDateString()]})]})]})},t))})]})]})]})}export{F as default};
