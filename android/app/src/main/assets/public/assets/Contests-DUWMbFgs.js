import{u as f,r as s,s as i,j as e,p as r,n as j,e as k}from"./index-CGemffCt.js";import{C as w}from"./clock-CH5mnwFd.js";import{M as v,T as N}from"./thumbs-up-BuKvcyEr.js";function S(){const{user:t}=f(),[n,c]=s.useState([]),[b,o]=s.useState(!0),m=s.useCallback(async()=>{if(!t)return;const{data:a,error:x}=await i.from("contests").select(`
        *,
        winner_badge:winner_badge_id(id, name, rank, points),
        runner_up_badge:runner_up_badge_id(id, name, rank, points),
        participant_badge:participant_badge_id(id, name, rank, points)
      `).in("status",["active","voting","upcoming"]).order("start_date",{ascending:!0});if(x){console.error("Error loading contests:",x),o(!1);return}const p=await Promise.all((a||[]).map(async d=>{const{count:h}=await i.from("contest_entries").select("id",{count:"exact",head:!0}).eq("contest_id",d.id),{data:g}=await i.from("contest_entries").select("id").eq("contest_id",d.id).eq("user_id",t.id).maybeSingle();return{...d,entry_count:h||0,user_has_entered:!!g}}));c(p),o(!1)},[t]);s.useEffect(()=>{t&&m()},[t,m]);const u=a=>{switch(a){case"upcoming":return"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/20 dark:text-cyan-400";case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"voting":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400";default:return"bg-slate-100 text-slate-800 dark:bg-slate-900/20 dark:text-slate-400"}},l=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 pb-24",children:[e.jsxs("div",{className:"relative bg-gradient-to-r from-amber-600 via-yellow-600 to-orange-600 h-32 sm:h-40",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[e.jsx(r,{className:"w-10 h-10 sm:w-12 sm:h-12 mb-2 animate-pulse"}),e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold mb-1",children:"Poetry Contests"}),e.jsx("p",{className:"text-sm sm:text-base opacity-90",children:"Compete for recognition and prizes"})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 -mt-8 space-y-6",children:b?e.jsx("div",{className:"flex items-center justify-center py-16 bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-slate-200 dark:border-slate-800"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-amber-600 border-t-transparent animate-spin"})]})}):n.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-slate-900 rounded-3xl border border-slate-200 dark:border-slate-800 shadow-lg",children:[e.jsx(r,{className:"w-16 h-16 mx-auto mb-4 text-slate-300 dark:text-slate-700"}),e.jsx("p",{className:"text-lg text-slate-500 dark:text-slate-400 font-medium",children:"No active contests at the moment"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(a=>e.jsxs("div",{className:"group bg-white dark:bg-slate-900 rounded-3xl shadow-lg border border-slate-200 dark:border-slate-800 p-6 sm:p-8 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02]",children:[e.jsx("div",{className:"flex items-start justify-between mb-4 gap-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-xl sm:text-2xl font-bold text-slate-900 dark:text-white mb-3 flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-yellow-500 rounded-2xl shadow-lg",children:e.jsx(r,{className:"text-white",size:24})}),e.jsx("span",{className:"truncate",children:a.title})]}),e.jsx("span",{className:`inline-block px-4 py-2 rounded-xl text-sm font-bold shadow-lg ${u(a.status)}`,children:a.status.toUpperCase()})]})}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 dark:text-slate-400 mb-4 line-clamp-3 leading-relaxed",children:a.description}),a.theme&&e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 rounded-2xl border border-amber-200 dark:border-amber-800",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-700 dark:text-amber-300 mb-1",children:"Theme"}),e.jsx("p",{className:"text-base text-slate-900 dark:text-white font-serif italic",children:a.theme})]}),e.jsxs("div",{className:"space-y-2 mb-4 p-4 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-800/50 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(w,{className:"text-slate-600 dark:text-slate-400 flex-shrink-0",size:16}),e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[a.status==="upcoming"&&`Starts ${l(a.start_date)}`,a.status==="active"&&`Ends ${l(a.end_date)}`,a.status==="voting"&&`Voting ends ${l(a.voting_end_date)}`]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(j,{className:"text-slate-600 dark:text-slate-400 flex-shrink-0",size:16}),e.jsxs("span",{className:"font-semibold text-slate-900 dark:text-white",children:[a.entry_count," entries"]})]})]}),(a.winner_badge||a.runner_up_badge||a.participant_badge)&&e.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-2xl border-2 border-emerald-200 dark:border-emerald-800",children:[e.jsx("p",{className:"text-sm font-bold text-emerald-800 dark:text-emerald-300 mb-3",children:"Badge Rewards"}),e.jsxs("div",{className:"space-y-2",children:[a.winner_badge&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(r,{className:"text-yellow-600 dark:text-yellow-400 flex-shrink-0",size:16}),e.jsxs("span",{className:"text-emerald-900 dark:text-emerald-200 font-medium",children:[e.jsx("strong",{children:"1st:"})," ",a.winner_badge.name," (",a.winner_badge.rank," • ",a.winner_badge.points," pts)"]})]}),a.runner_up_badge&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(v,{className:"text-slate-400 flex-shrink-0",size:16}),e.jsxs("span",{className:"text-emerald-900 dark:text-emerald-200 font-medium",children:[e.jsx("strong",{children:"2nd-3rd:"})," ",a.runner_up_badge.name," (",a.runner_up_badge.rank," • ",a.runner_up_badge.points," pts)"]})]}),a.participant_badge&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(k,{className:"text-violet-500 flex-shrink-0",size:16}),e.jsxs("span",{className:"text-emerald-900 dark:text-emerald-200 font-medium",children:[e.jsx("strong",{children:"All:"})," ",a.participant_badge.name," (",a.participant_badge.rank," • ",a.participant_badge.points," pts)"]})]})]})]}),a.status==="active"&&e.jsx("button",{disabled:a.user_has_entered,className:`w-full px-6 py-3 rounded-xl font-semibold shadow-lg transition-all duration-300 text-base ${a.user_has_entered?"bg-slate-200 dark:bg-slate-800 text-slate-600 dark:text-slate-400 cursor-not-allowed":"bg-gradient-to-r from-amber-500 to-yellow-500 hover:from-amber-600 hover:to-yellow-600 text-white hover:shadow-xl hover:scale-105"}`,children:a.user_has_entered?"Already Entered":"Submit Entry"}),a.status==="voting"&&e.jsxs("button",{className:"w-full px-6 py-3 bg-gradient-to-r from-violet-500 to-purple-500 hover:from-violet-600 hover:to-purple-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 flex items-center justify-center gap-2 text-base",children:[e.jsx(N,{size:18}),"Vote Now"]})]},a.id))})})]})}export{S as default};
