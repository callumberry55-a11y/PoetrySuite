import{u as A,r,s as b,j as e,l as f,A as j}from"./index-2dP_p1EG.js";import{S}from"./star-Ba8Tco0X.js";import{L as $}from"./lock-R6dZoUXY.js";function L(){const{user:l}=A(),[d,w]=r.useState([]),[N,c]=r.useState(!0),[n,o]=r.useState("all"),[x,k]=r.useState("all"),m=r.useCallback(async()=>{if(!l)return;const{data:t,error:i}=await b.from("badges").select("*").order("points",{ascending:!1});if(i){console.error("Error loading badges:",i),c(!1);return}const{data:a,error:g}=await b.from("user_badges").select("badge_id, earned_at").eq("user_id",l.id);g&&console.error("Error loading user badges:",g);const _=new Set((a==null?void 0:a.map(s=>s.badge_id))||[]),E=new Map((a==null?void 0:a.map(s=>[s.badge_id,s.earned_at]))||[]),C=(t||[]).map(s=>({...s,earned:_.has(s.id),earned_at:E.get(s.id)}));w(C),c(!1)},[l]);r.useEffect(()=>{l&&m()},[l,m]);const p=t=>{switch(t){case"Ollamh":return"from-yellow-400 to-yellow-600";case"Anruth":return"from-purple-400 to-violet-600";case"Cli":return"from-green-400 to-green-600";case"Fochlog":return"from-slate-400 to-slate-600";default:return"from-slate-400 to-slate-600"}},u=t=>{switch(t){case"Ollamh":return"Master";case"Anruth":return"Expert";case"Cli":return"Journeyman";case"Fochlog":return"Apprentice";default:return t}},h=d.filter(t=>!(n==="earned"&&!t.earned||n==="locked"&&t.earned||x!=="all"&&t.rank!==x)),v=d.filter(t=>t.earned).length,y=d.filter(t=>t.earned).reduce((t,i)=>t+i.points,0);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:py-8 pb-24",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 dark:text-white mb-1 sm:mb-2",children:"Badges"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 dark:text-slate-400",children:"Earn badges by achieving milestones in your poetry journey"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 sm:gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-3 sm:p-4 text-center",children:[e.jsx(f,{className:"mx-auto mb-2 text-yellow-500",size:20}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-slate-900 dark:text-white",children:v}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:"Earned"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-3 sm:p-4 text-center",children:[e.jsx(S,{className:"mx-auto mb-2 text-purple-500",size:20}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-slate-900 dark:text-white",children:y}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:"Points"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-3 sm:p-4 text-center",children:[e.jsx(j,{className:"mx-auto mb-2 text-green-500",size:20}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-slate-900 dark:text-white",children:d.length}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400",children:"Total"})]})]}),e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 sm:pb-0",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap ${n==="all"?"bg-purple-500 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"All"}),e.jsx("button",{onClick:()=>o("earned"),className:`px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap ${n==="earned"?"bg-purple-500 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"Earned"}),e.jsx("button",{onClick:()=>o("locked"),className:`px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap ${n==="locked"?"bg-purple-500 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:"Locked"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 sm:pb-0",children:["all","Fochlog","Cli","Anruth","Ollamh"].map(t=>e.jsx("button",{onClick:()=>k(t),className:`px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors whitespace-nowrap ${x===t?"bg-green-500 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,children:t==="all"?"All Ranks":u(t)},t))})]}),N?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):h.length===0?e.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-800 rounded-lg",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No badges found"})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:h.map(t=>e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-lg p-4 sm:p-6 relative overflow-hidden ${t.earned?"ring-2 ring-green-500":"opacity-60"}`,children:[t.earned&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"bg-green-500 text-white rounded-full p-1",children:e.jsx(j,{size:14})})}),e.jsx("div",{className:`w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gradient-to-br ${p(t.rank)} flex items-center justify-center mx-auto mb-3 sm:mb-4 ${!t.earned&&"opacity-40"}`,children:t.earned?e.jsx(f,{className:"text-white",size:28}):e.jsx($,{className:"text-white",size:28})}),e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("h3",{className:"font-bold text-sm sm:text-base text-slate-900 dark:text-white mb-1",children:t.name}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400 mb-2",children:t.description}),e.jsxs("div",{className:`inline-block px-2 py-1 rounded text-xs font-medium bg-gradient-to-r ${p(t.rank)} text-white`,children:[u(t.rank)," â€¢ ",t.points," pts"]})]}),t.earned&&t.earned_at&&e.jsxs("div",{className:"text-center text-xs text-slate-500 dark:text-slate-500 mt-2",children:["Earned ",new Date(t.earned_at).toLocaleDateString()]}),!t.earned&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:["Requirement: ",t.requirement_value," ",t.requirement_type.replace(/_/g," ")]})})]},t.id))})]})}export{L as default};
