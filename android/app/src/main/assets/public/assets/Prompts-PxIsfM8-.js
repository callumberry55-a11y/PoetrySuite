import{u as $,r as s,s as d,j as e,L as p,S as A,X as G}from"./index-CGemffCt.js";import{b as M}from"./ai-DtILrpuj.js";import{C as Y}from"./calendar-_Ckto2X5.js";import{E as K}from"./eye-CihzmZqK.js";import{P as U}from"./pen-HIgjliAM.js";import{S as B}from"./save-DRwAVCRA.js";import{C as O}from"./check-DWnmZAgF.js";function ee(){const{user:a}=$(),[v,w]=s.useState([]),[I,j]=s.useState(!0),[k,N]=s.useState(!1),[y,_]=s.useState(null),[l,c]=s.useState("all"),[x,b]=s.useState(null),[z,h]=s.useState(!1),[o,i]=s.useState(""),[S,C]=s.useState(!1),[n,m]=s.useState(null),[P,E]=s.useState(!1);s.useEffect(()=>{E(!0)},[]);const g=s.useCallback(async()=>{if(a){j(!0);try{const{data:t,error:r}=await d.from("daily_prompts").select("*").order("prompt_date",{ascending:!1}).limit(30);if(r)throw r;const u=await Promise.all((t||[]).map(async f=>{const{count:q}=await d.from("prompt_responses").select("id",{count:"exact",head:!0}).eq("prompt_id",f.id),{data:L}=await d.from("prompt_responses").select("id").eq("prompt_id",f.id).eq("user_id",a.id).maybeSingle();return{...f,response_count:q||0,user_has_responded:!!L}}));w(u)}catch(t){console.error("Error loading prompts:",t),w([])}finally{j(!1)}}},[a]);s.useEffect(()=>{a&&g()},[a,g]);const F=async()=>{N(!0);try{const t=await M();_(t)}catch(t){console.error("Failed to generate AI prompt:",t)}finally{N(!1)}},D=async t=>{if(b(t),i(""),m(null),t.user_has_responded)try{const{data:r,error:u}=await d.from("prompt_responses").select("*").eq("prompt_id",t.id).eq("user_id",a==null?void 0:a.id).maybeSingle();if(u)throw u;r&&(m(r),i(r.content))}catch(r){console.error("Error loading response:",r)}h(!0)},W=async()=>{if(!(!a||!x||!o.trim())){C(!0);try{if(n){const{error:t}=await d.from("prompt_responses").update({content:o,updated_at:new Date().toISOString()}).eq("id",n.id);if(t)throw t}else{const{error:t}=await d.from("prompt_responses").insert({prompt_id:x.id,user_id:a.id,content:o});if(t)throw t}h(!1),i(""),b(null),m(null),g()}catch(t){console.error("Error submitting response:",t),alert("Failed to submit response. Please try again.")}finally{C(!1)}}},R=l==="all"?v:v.filter(t=>t.category===l);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 pb-24",children:[e.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-cyan-600 to-teal-600 h-32 sm:h-40",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[e.jsx(p,{className:"w-10 h-10 sm:w-12 sm:h-12 mb-2 animate-pulse"}),e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold mb-1",children:"Writing Prompts"}),e.jsx("p",{className:"text-sm sm:text-base opacity-90",children:"Get inspired and overcome writer's block"})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 -mt-8 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Need instant inspiration?"}),e.jsxs("button",{onClick:F,disabled:k||!P,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-500 to-fuchsia-500 text-white rounded-xl font-semibold hover:from-violet-600 hover:to-fuchsia-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl hover:scale-105 duration-300",title:P?"Generate AI writing prompt":"AI features unavailable - API key not configured",children:[e.jsx(A,{size:20}),k?"Generating...":"AI Prompt"]})]}),y&&e.jsx("div",{className:"p-6 bg-gradient-to-br from-violet-50 to-fuchsia-50 dark:from-violet-900/20 dark:to-fuchsia-900/20 border-2 border-violet-300 dark:border-violet-700 rounded-2xl animate-in slide-in-from-top duration-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-violet-500 to-fuchsia-500 rounded-2xl shadow-lg",children:e.jsx(A,{className:"text-white",size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg text-violet-900 dark:text-violet-100 mb-2",children:"AI-Generated Prompt"}),e.jsx("p",{className:"text-slate-800 dark:text-slate-200 leading-relaxed mb-3 italic",children:y}),e.jsx("button",{onClick:()=>_(null),className:"text-sm px-4 py-2 bg-violet-200 dark:bg-violet-800 text-violet-800 dark:text-violet-200 rounded-xl hover:bg-violet-300 dark:hover:bg-violet-700 font-semibold transition-all",children:"Dismiss"})]})]})})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx("button",{onClick:()=>c("all"),className:`px-5 py-3 rounded-xl font-semibold transition-all duration-300 text-sm sm:text-base shadow-lg ${l==="all"?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white scale-105":"bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-700"}`,children:"All"}),e.jsx("button",{onClick:()=>c("theme"),className:`px-5 py-3 rounded-xl font-semibold transition-all duration-300 text-sm sm:text-base shadow-lg ${l==="theme"?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white scale-105":"bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-700"}`,children:"Theme"}),e.jsx("button",{onClick:()=>c("form"),className:`px-5 py-3 rounded-xl font-semibold transition-all duration-300 text-sm sm:text-base shadow-lg ${l==="form"?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white scale-105":"bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-700"}`,children:"Form"}),e.jsx("button",{onClick:()=>c("word"),className:`px-5 py-3 rounded-xl font-semibold transition-all duration-300 text-sm sm:text-base shadow-lg ${l==="word"?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white scale-105":"bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-700"}`,children:"Word"}),e.jsx("button",{onClick:()=>c("image"),className:`px-5 py-3 rounded-xl font-semibold transition-all duration-300 text-sm sm:text-base shadow-lg ${l==="image"?"bg-gradient-to-r from-blue-500 to-cyan-500 text-white scale-105":"bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-700"}`,children:"Image"})]}),I?e.jsx("div",{className:"flex items-center justify-center py-16 bg-white dark:bg-slate-900 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-slate-200 dark:border-slate-800"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-blue-600 border-t-transparent animate-spin"})]})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[R.map(t=>e.jsxs("div",{className:"group bg-white dark:bg-slate-900 rounded-3xl shadow-lg border border-slate-200 dark:border-slate-800 p-6 hover:shadow-2xl transition-all duration-300 hover:scale-[1.02]",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-500 shadow-lg",children:e.jsx(p,{className:"text-white",size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"inline-block px-3 py-1 rounded-xl text-sm font-semibold bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-800 dark:to-slate-700 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600 mb-2",children:t.category}),t.user_has_responded&&e.jsx("span",{className:"ml-2 px-3 py-1 rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs font-semibold shadow-lg",children:"âœ“ Responded"})]})]}),e.jsxs("p",{className:"text-lg text-slate-900 dark:text-white font-serif mb-4 italic leading-relaxed",children:['"',t.prompt_text,'"']}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm p-3 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-800/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-400 font-medium",children:[e.jsx(Y,{size:16}),new Date(t.prompt_date).toLocaleDateString()]}),e.jsxs("span",{className:"text-slate-700 dark:text-slate-300 font-semibold",children:[t.response_count," ",t.response_count===1?"response":"responses"]})]}),e.jsx("button",{onClick:()=>D(t),className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-semibold shadow-lg transition-all duration-300 hover:scale-[1.02] ${t.user_has_responded?"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white":"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white"}`,children:t.user_has_responded?e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18}),"View My Response"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{size:18}),"Write Response"]})})]})]},t.id)),R.length===0&&e.jsxs("div",{className:"col-span-full text-center py-16 bg-white dark:bg-slate-900 rounded-3xl border border-slate-200 dark:border-slate-800 shadow-lg",children:[e.jsx(p,{className:"w-16 h-16 mx-auto mb-4 text-slate-300 dark:text-slate-700"}),e.jsx("p",{className:"text-lg text-slate-500 dark:text-slate-400 font-medium",children:"No prompts available in this category"})]})]})]}),z&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-2xl border-2 border-slate-200 dark:border-slate-800 max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 via-cyan-600 to-teal-600 p-6 rounded-t-3xl flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:e.jsx(p,{className:"w-6 h-6 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:n?"Your Response":"Write Your Response"})]}),e.jsxs("p",{className:"text-white/90 text-lg italic",children:['"',x.prompt_text,'"']})]}),e.jsx("button",{onClick:()=>{h(!1),b(null),i(""),m(null)},className:"p-2 hover:bg-white/20 rounded-xl transition-all",children:e.jsx(G,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("textarea",{value:o,onChange:t=>i(t.target.value),placeholder:"Write your response to this prompt...",className:"w-full min-h-[300px] p-4 rounded-2xl border-2 border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all font-serif text-base leading-relaxed"}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:[o.trim().split(/\s+/).filter(Boolean).length," words"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{h(!1),b(null),i(""),m(null)},className:"px-6 py-3 rounded-xl bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 font-semibold hover:bg-slate-300 dark:hover:bg-slate-700 transition-all",children:"Cancel"}),e.jsx("button",{onClick:W,disabled:!o.trim()||S,className:"flex items-center gap-2 px-6 py-3 rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{size:18}),n?"Update Response":"Save Response"]})})]})]}),n&&e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-300 dark:border-green-700 rounded-2xl flex items-start gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-green-800 dark:text-green-200",children:"You've already responded to this prompt"}),e.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300 mt-1",children:["Last updated: ",new Date(n.created_at).toLocaleDateString()]})]})]})]})]})})]})}export{ee as default};
