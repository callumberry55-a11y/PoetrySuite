import{c as N,r as d,u as M,s as L,j as e,B as A}from"./index-DSaTw0cA.js";import{T as W}from"./trending-up-BaJojG_O.js";import{C as z}from"./calendar-BRIXopbd.js";const C=N("Feather",[["path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z",key:"u4sw5n"}],["line",{x1:"16",x2:"2",y1:"8",y2:"22",key:"1c47m2"}],["line",{x1:"17.5",x2:"9",y1:"15",y2:"15",key:"2fj3pr"}]]);const E=N("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);function F(){const{user:x}=M(),[b,k]=d.useState([]),[y,v]=d.useState(0),[D,S]=d.useState(0),[_,g]=d.useState(0),[T,j]=d.useState(0),f=d.useCallback(s=>{if(s.length===0){g(0),j(0);return}const a=Array.from(new Set(s.map(n=>new Date(n.created_at).toDateString()))).sort((n,c)=>new Date(c).getTime()-new Date(n).getTime()),i=new Date;i.setHours(0,0,0,0);let r=0,m=new Date(i);for(const n of a){const c=new Date(n);if(c.setHours(0,0,0,0),c.getTime()===m.getTime())r++,m.setDate(m.getDate()-1);else break}let l=0,t=1;for(let n=0;n<a.length-1;n++){const c=new Date(a[n]),p=new Date(a[n+1]);c.setHours(0,0,0,0),p.setHours(0,0,0,0),Math.floor((c.getTime()-p.getTime())/(1e3*60*60*24))===1?t++:(l=Math.max(l,t),t=1)}l=Math.max(l,t,r),g(r),j(l)},[]),w=d.useCallback(async()=>{if(!x)return;const{data:s,error:a}=await L.from("poems").select("id, created_at, word_count").eq("user_id",x.id).order("created_at",{ascending:!1});if(a){console.error("Error loading poems:",a);return}const i=s||[];v(i.length),S(i.reduce((l,t)=>l+(t.word_count||0),0)),f(i);const r={};i.forEach(l=>{const t=new Date(l.created_at).toISOString().split("T")[0];r[t]||(r[t]={date:t,poems_written:0,words_written:0,minutes_writing:0}),r[t].poems_written++,r[t].words_written+=l.word_count||0,r[t].minutes_writing+=Math.ceil((l.word_count||0)/50)});const m=Object.values(r).sort((l,t)=>new Date(t.date).getTime()-new Date(l.date).getTime()).slice(0,30);k(m)},[x,f]);d.useEffect(()=>{x&&w()},[x,w]);const o=d.useMemo(()=>b.slice(0,7).reverse(),[b]),h=d.useMemo(()=>o.reduce((s,a)=>s+a.words_written,0),[o]),u=d.useMemo(()=>o.reduce((s,a)=>s+a.poems_written,0),[o]);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-8",children:"Your Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(A,{className:"text-blue-600 dark:text-blue-400",size:24})})}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:y}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total Poems"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:e.jsx(C,{className:"text-green-600 dark:text-green-400",size:24})})}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:D.toLocaleString()}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total Words"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:e.jsx(E,{className:"text-orange-600 dark:text-orange-400",size:24})})}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:_}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Day Streak"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:e.jsx(W,{className:"text-purple-600 dark:text-purple-400",size:24})})}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:T}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Longest Streak"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-6",children:"Last 7 Days Activity"}),e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-center py-8",children:"No activity in the last 7 days"}):o.map(s=>{const a=new Date(s.date),i=a.toLocaleDateString("en-US",{weekday:"short"}),r=a.toLocaleDateString("en-US",{month:"short",day:"numeric"});return e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-200 dark:border-slate-700 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(z,{className:"text-blue-600 dark:text-blue-400",size:18})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-slate-900 dark:text-white",children:[i,", ",r]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[s.poems_written," poems, ",s.words_written," words"]})]})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:[s.minutes_writing," min"]})]},s.date)})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-6",children:"Weekly Summary"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Poems Written"}),e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${Math.min(u/7*100,100)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Words Written"}),e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:h.toLocaleString()})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${Math.min(h/1e3*100,100)}%`}})})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:"Average per day (last 7 days)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:(u/7).toFixed(1)}),e.jsx("p",{className:"text-xs text-slate-500",children:"poems/day"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:Math.round(h/7)}),e.jsx("p",{className:"text-xs text-slate-500",children:"words/day"})]})]})]})]})]})]})]})}const q=d.memo(F);export{q as default};
